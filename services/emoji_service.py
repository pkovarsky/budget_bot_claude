"""
–°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–º–∞–π–ª–∏–∫–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
"""

from typing import Dict, List

class EmojiService:
    """–°–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–º–∞–π–ª–∏–∫–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
    
    @staticmethod
    def get_category_emojis() -> Dict[str, List[str]]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–º–∞–π–ª–∏–∫–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
        return {
            "–ü—Ä–æ–¥—É–∫—Ç—ã": ["üõí", "üçï", "üçî", "ü•ó", "üçé", "üõçÔ∏è", "ü•ñ", "üçû", "ü•õ", "üßÄ", "üçä", "ü•ï", "ü•¨", "üçå", "üçá", "ü•©", "üçó", "ü•ö", "üçö", "üçú"],
            "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç": ["üöó", "üöï", "üöå", "üöá", "‚úàÔ∏è", "üö≤", "üõ¥", "‚õΩ", "üö¶", "üöô", "üöõ", "üöê", "üèçÔ∏è", "üöÅ", "üõµ", "üöÜ", "üöà", "üöä", "üöù", "üöû"],
            "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": ["üé¨", "üé≠", "üé™", "üé®", "üéÆ", "üéØ", "üé≤", "üé∏", "üé§", "üéπ", "üé™", "üé®", "üéµ", "üé∂", "üéª", "üé∫", "üéº", "üéß", "üéØ", "üé≥"],
            "–ó–¥–æ—Ä–æ–≤—å–µ": ["üè•", "üíä", "ü©∫", "üíâ", "üß¨", "üèÉ‚Äç‚ôÇÔ∏è", "üßò‚Äç‚ôÄÔ∏è", "üí™", "ü¶∑", "üëÅÔ∏è", "ü©π", "üß¥", "üßº", "üßΩ", "üßª", "üèÉ‚Äç‚ôÄÔ∏è", "ü§∏‚Äç‚ôÇÔ∏è", "ü§∏‚Äç‚ôÄÔ∏è", "üßò‚Äç‚ôÇÔ∏è", "‚ù§Ô∏è"],
            "–û–¥–µ–∂–¥–∞": ["üëï", "üëî", "üëó", "üë†", "üëü", "üß•", "üëú", "üíÑ", "üíç", "üëì", "üëñ", "üëö", "üëí", "üß¢", "üß£", "üß§", "ü•æ", "üë¢", "üë°", "ü•ø"],
            "–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏": ["üè†", "üí°", "üîå", "üöø", "üî•", "‚ùÑÔ∏è", "üìû", "üì∂", "üíª", "üì∫", "üè°", "üèòÔ∏è", "üèóÔ∏è", "üîß", "üî®", "‚ö°", "üíß", "üå°Ô∏è", "üè≠", "üè¢"],
            "–†–µ—Å—Ç–æ—Ä–∞–Ω": ["üçΩÔ∏è", "üç¥", "‚òï", "üç∑", "üç∫", "ü•Ç", "üç∞", "üßÅ", "üç©", "üç™", "ü•ò", "üç≤", "ü•ô", "üåÆ", "üåØ", "üç≥", "ü•û", "üßá", "ü•Ø", "üç±"],
            "–†–∞–±–æ—Ç–∞": ["üíº", "üñ•Ô∏è", "üìä", "üìà", "üìã", "‚úèÔ∏è", "üìù", "üíª", "üñ®Ô∏è", "üìû", "üè¢", "üè¨", "üè≠", "üè¶", "üè™", "üí∞", "üí≥", "üí∏", "üìÑ", "üìë"],
            "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ": ["üìö", "üéì", "‚úèÔ∏è", "üìñ", "üñäÔ∏è", "üìê", "üßÆ", "üî¨", "üéí", "üë®‚Äçüéì", "üìù", "üìÑ", "üñçÔ∏è", "‚úÇÔ∏è", "üìè", "üìå", "üìç", "üóÇÔ∏è", "üìÖ", "üóìÔ∏è"],
            "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è": ["‚úàÔ∏è", "üè®", "üß≥", "üó∫Ô∏è", "üì∑", "üé´", "üö¢", "üöÇ", "üèñÔ∏è", "üèîÔ∏è", "üåç", "üåé", "üåè", "üóΩ", "üé°", "üé¢", "üé†", "üé™", "üé≠", "üé®"],
            "–°–ø–æ—Ä—Ç": ["‚öΩ", "üèÄ", "üéæ", "üèê", "üèà", "ü•ä", "üèãÔ∏è‚Äç‚ôÇÔ∏è", "üèÉ‚Äç‚ôÄÔ∏è", "üö¥‚Äç‚ôÇÔ∏è", "üèä‚Äç‚ôÄÔ∏è", "ü•á", "üèÜ", "üéØ", "üé≥", "‚õ≥", "üèì", "üè∏", "ü§æ‚Äç‚ôÇÔ∏è", "ü§æ‚Äç‚ôÄÔ∏è", "üßò‚Äç‚ôÇÔ∏è"],
            "–î–æ–º": ["üè†", "üõèÔ∏è", "üõãÔ∏è", "üö™", "ü™ü", "üßπ", "üßΩ", "üîß", "üî®", "ü™¥", "üè°", "üèòÔ∏è", "üß∫", "üß¥", "üßº", "üßª", "ü™£", "üßΩ", "üßØ", "üõ†Ô∏è"],
            "–ü—Ä–æ—á–µ–µ": ["üìÅ", "üìÇ", "üí∞", "üí≥", "üí∏", "üíµ", "üí¥", "üí∂", "üí∑", "üè¶", "‚ùì", "‚ùî", "üîç", "üîé", "üì¶", "üìã", "üìÑ", "üìÉ", "üìë", "üìä"],
            "–û–±—â–µ–µ": ["üìÅ", "üìÇ", "üí∞", "üí≥", "üí∏", "üíµ", "üí¥", "üí∂", "üí∑", "üè¶", "‚ùì", "‚ùî", "üîç", "üîé", "üì¶", "üìã", "üìÑ", "üìÉ", "üìë", "üìä"]
        }
    
    @staticmethod
    def get_popular_emojis() -> List[str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–º–∞–π–ª–∏–∫–æ–≤"""
        return [
            "üí∞", "üí∏", "üí≥", "üíµ", "üè¶", "üìÅ", "üìÇ", "üõí", "üõçÔ∏è", "üçï",
            "üöó", "üè†", "üé¨", "üè•", "üëï", "üí°", "üçΩÔ∏è", "üíº", "üìö", "‚úàÔ∏è",
            "‚öΩ", "üéÆ", "‚òï", "üì±", "üéØ", "üî•", "‚≠ê", "‚ù§Ô∏è", "üéâ", "üéä",
            "üé≠", "üé™", "üé®", "üéµ", "üé∂", "üéª", "üé∫", "üéº", "üéß", "üé≥",
            "üèÉ‚Äç‚ôÇÔ∏è", "üèÉ‚Äç‚ôÄÔ∏è", "üí™", "üßò‚Äç‚ôÇÔ∏è", "üßò‚Äç‚ôÄÔ∏è", "ü§∏‚Äç‚ôÇÔ∏è", "ü§∏‚Äç‚ôÄÔ∏è", "üèãÔ∏è‚Äç‚ôÇÔ∏è", "üèãÔ∏è‚Äç‚ôÄÔ∏è", "üö¥‚Äç‚ôÇÔ∏è"
        ]
    
    @staticmethod
    def get_emoji_by_category_name(category_name: str) -> str:
        """–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–º–∞–π–ª–∏–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
        category_emojis = EmojiService.get_category_emojis()
        category_name_lower = category_name.lower()
        
        # –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        for cat_type, emojis in category_emojis.items():
            if cat_type.lower() == category_name_lower:
                return emojis[0]
        
        # –ü–æ–∏—Å–∫ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ
        for cat_type, emojis in category_emojis.items():
            if cat_type.lower() in category_name_lower or category_name_lower in cat_type.lower():
                return emojis[0]
        
        # –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
        keyword_mapping = {
            "–ø—Ä–æ–¥—É–∫—Ç—ã": "üõí", "–µ–¥–∞": "üçï", "–º–∞–≥–∞–∑–∏–Ω": "üõí", "—Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç": "üõí",
            "—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç": "üöó", "—Ç–∞–∫—Å–∏": "üöï", "–∞–≤—Ç–æ–±—É—Å": "üöå", "–º–µ—Ç—Ä–æ": "üöá",
            "—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": "üé¨", "–∫–∏–Ω–æ": "üé¨", "—Ç–µ–∞—Ç—Ä": "üé≠", "–∏–≥—Ä—ã": "üéÆ",
            "–∑–¥–æ—Ä–æ–≤—å–µ": "üè•", "–º–µ–¥–∏—Ü–∏–Ω–∞": "üè•", "–∞–ø—Ç–µ–∫–∞": "üíä", "–≤—Ä–∞—á": "ü©∫",
            "–æ–¥–µ–∂–¥–∞": "üëï", "–æ–±—É–≤—å": "üë†", "–º–æ–¥–∞": "üëó", "–º–∞–≥–∞–∑–∏–Ω –æ–¥–µ–∂–¥—ã": "üëï",
            "–∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ": "üè†", "—Å–≤–µ—Ç": "üí°", "–≤–æ–¥–∞": "üöø", "–≥–∞–∑": "üî•",
            "—Ä–µ—Å—Ç–æ—Ä–∞–Ω": "üçΩÔ∏è", "–∫–∞—Ñ–µ": "‚òï", "–±–∞—Ä": "üç∑", "–µ–¥–∞": "üç¥",
            "—Ä–∞–±–æ—Ç–∞": "üíº", "–æ—Ñ–∏—Å": "üñ•Ô∏è", "–¥–µ–Ω—å–≥–∏": "üí∞", "–∑–∞—Ä–ø–ª–∞—Ç–∞": "üí∞",
            "–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ": "üìö", "—É—á–µ–±–∞": "üéì", "—à–∫–æ–ª–∞": "üìö", "—É–Ω–∏–≤–µ—Ä": "üéì",
            "–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è": "‚úàÔ∏è", "–æ—Ç–ø—É—Å–∫": "üèñÔ∏è", "–æ—Ç–µ–ª—å": "üè®", "–ø–æ–µ–∑–¥–∫–∞": "üß≥",
            "—Å–ø–æ—Ä—Ç": "‚öΩ", "—Ñ–∏—Ç–Ω–µ—Å": "üèãÔ∏è‚Äç‚ôÇÔ∏è", "–∑–∞–ª": "üí™", "—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞": "üèÉ‚Äç‚ôÇÔ∏è",
            "–¥–æ–º": "üè†", "–∫–≤–∞—Ä—Ç–∏—Ä–∞": "üè†", "–º–µ–±–µ–ª—å": "üõãÔ∏è", "—Ä–µ–º–æ–Ω—Ç": "üîß",
            "–ø—Ä–æ—á–µ–µ": "üìÅ", "—Ä–∞–∑–Ω–æ–µ": "üìÇ", "–¥—Ä—É–≥–æ–µ": "‚ùì", "–æ–±—â–µ–µ": "üìÅ"
        }
        
        for keyword, emoji in keyword_mapping.items():
            if keyword in category_name_lower:
                return emoji
        
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
        return "üìÅ"
    
    @staticmethod
    def create_emoji_keyboard(category_type: str = "–û–±—â–µ–µ") -> List[List[str]]:
        """–°–æ–∑–¥–∞—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–º–∞–π–ª–∏–∫–∞"""
        category_emojis = EmojiService.get_category_emojis()
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–º–∞–π–ª–∏–∫–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        emojis = category_emojis.get(category_type, EmojiService.get_popular_emojis())
        
        # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É 5x2
        keyboard = []
        for i in range(0, min(len(emojis), 10), 5):
            row = emojis[i:i+5]
            keyboard.append(row)
        
        return keyboard
    
    @staticmethod
    def get_emoji_keyboard_for_category(category_name: str) -> List[List[str]]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å–º–∞–π–ª–∏–∫–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
        category_emojis = EmojiService.get_category_emojis()
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        category_name_lower = category_name.lower()
        
        # –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ç–∏–ø
        for cat_type in category_emojis.keys():
            if cat_type.lower() in category_name_lower or category_name_lower in cat_type.lower():
                return EmojiService.create_emoji_keyboard(cat_type)
        
        # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ
        return EmojiService.create_emoji_keyboard("–û–±—â–µ–µ")
    
    @staticmethod
    def is_valid_emoji(emoji: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç—Ä–æ–∫–∞ –≤–∞–ª–∏–¥–Ω—ã–º —Å–º–∞–π–ª–∏–∫–æ–º"""
        # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–æ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –∏ –Ω–µ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
        return len(emoji) <= 4 and not emoji.isalnum() and emoji.strip() != ""